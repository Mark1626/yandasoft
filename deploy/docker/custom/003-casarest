FROM 002-casacore:latest

ENV CASAREST_VERSION 1.7.0
ENV CMAKE_BUILD_PARALLEL_LEVEL NUM_THREADS
ENV CXXFLAGS -march=native

RUN mkdir -p /home/yanda/casarest-build
WORKDIR /home/yanda/casarest-build

RUN wget https://github.com/casacore/casarest/archive/refs/tags/v${CASAREST_VERSION}.tar.gz
RUN tar -xvf v${CASAREST_VERSION}.tar.gz
RUN cd casarest-${CASAREST_VERSION} && mkdir build && cd build && \
cmake .. -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=Release && \
make -j $CMAKE_BUILD_PARALLEL_LEVEL && \
make install 
