FROM 003-casarest:latest as buildenv

RUN apt-get remove -y cmake
RUN wget https://github.com/Kitware/CMake/releases/download/v3.20.3/cmake-3.20.3-linux-x86_64.tar.gz -P /tmp/cmake-build/cmake
RUN tar -xvf /tmp/cmake-build/cmake/cmake-3.20.3-linux-x86_64.tar.gz -C /tmp/cmake-build/cmake

RUN apt-get install -y linux-tools-common linux-tools-generic vim valgrind tmux

ENV PATH "$PATH:/home/yanda/build/apps"
ENV PATH "$PATH:/tmp/cmake-build/cmake/cmake-3.20.3-linux-x86_64/bin/"
ENV CASACORE_SW_DIR "/usr/local/share/casacore"

RUN echo "measures.DE200.directory: ${CASACORE_SW_DIR}/data/ephemerides" >> /root/.casarc && \
echo "measures.DE405.directory: ${CASACORE_SW_DIR}/data/ephemerides" >> /root/.casarc && \
echo "measures.line.directory: ${CASACORE_SW_DIR}/data/ephemerides" >> /root/.casarc && \
echo "measures.sources.directory: ${CASACORE_SW_DIR}/data/ephemerides" >> /root/.casarc && \
echo "measures.comet.directory: ${CASACORE_SW_DIR}/data/ephemerides" >> /root/.casarc && \
echo "measures.ierseop97.directory: ${CASACORE_SW_DIR}/data/geodetic" >> /root/.casarc && \
echo "measures.ierspredict.directory: ${CASACORE_SW_DIR}/data/geodetic" >> /root/.casarc && \
echo "measures.tai_utc.directory: ${CASACORE_SW_DIR}/data/geodetic" >> /root/.casarc && \
echo "measures.igrf.directory: ${CASACORE_SW_DIR}/data/geodetic" >> /root/.casarc && \
echo "measures.observatory.directory: ${CASACORE_SW_DIR}/data/geodetic"

WORKDIR /home/yanda
